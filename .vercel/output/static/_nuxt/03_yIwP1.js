import{e as T,r as _,g as G,c as x,a as t,h as m,i as a,t as r,F as I,j as A,b as o,w as l,J as D,k as p,o as d,l as f,d as u,m as b,n as F}from"#entry";import{_ as g}from"./MSWrGCcy.js";import{_ as k}from"./DPT98cEI.js";import{_ as C,a as $,b as j,c as B}from"./gFKvgYVH.js";import{_ as N}from"./BePr-7gU.js";import{u as M}from"./BmWNdDnL.js";import"./BEHD0UYf.js";const O={class:"space-y-8"},R={key:0,class:"bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 shadow"},H={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},P={class:"text-lg md:text-xl font-semibold text-gray-900 dark:text-white"},J={class:"text-gray-700 dark:text-white text-sm md:text-base"},L={class:"flex items-center space-x-2"},X={class:"font-semibold text-black dark:text-white text-lg"},K={key:1,class:"text-center py-8"},Q={key:2,class:"space-y-6"},U={class:"text-2xl font-bold text-black dark:text-white mb-4"},W={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6"},Y={class:"flex items-center justify-between"},Z={class:"flex items-center space-x-2"},ee={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},te={class:"font-medium text-gray-900 dark:text-white mb-2"},se={class:"grid grid-cols-2 gap-2 text-sm"},ae={class:"flex justify-between"},re={class:"font-medium text-gray-900 dark:text-white"},le={class:"flex justify-between"},ie={class:"font-medium text-gray-900 dark:text-white"},ne={class:"flex justify-between"},oe={class:"font-medium text-gray-900 dark:text-white"},de={class:"flex justify-between"},ce={class:"font-medium text-gray-900 dark:text-white"},ue={class:"space-y-2"},xe={class:"flex items-center space-x-4 text-sm"},_e={class:"flex items-center space-x-1"},me={class:"text-gray-900 dark:text-white"},fe={class:"flex items-center space-x-1"},ge={class:"text-gray-900 dark:text-white"},ye={key:0,class:"flex items-center space-x-1"},ve={class:"text-gray-900 dark:text-white"},pe={key:1,class:"flex items-center space-x-1"},ke={class:"flex items-center justify-between"},he={class:"text-sm text-gray-900 dark:text-white"},we={class:"flex items-center justify-between"},be={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Ce={class:"text-gray-700 dark:text-gray-300 leading-relaxed"},$e={class:"text-center"},Te=T({__name:"modo-historia",setup(je){const i=M(),y=_([]),v=_(!1),c=_(null),h=_(0),q=n=>n.is_completed?"default":n.is_locked||n.chapter%5===0?"destructive":n.chapter%3===0?"default":"secondary",z=async()=>{if(i.currentCharacter){v.value=!0;try{const n=p("@mmo/ninja/token"),e=await $fetch("/api/story/chapters",{method:"GET",headers:{Authorization:`Bearer ${n.value}`},query:{character_id:i.currentCharacter.id}});e.success&&(y.value=e.data||[])}catch{}finally{v.value=!1}}},V=async()=>{if(i.currentCharacter)try{const n=p("@mmo/ninja/token"),e=await $fetch("/api/resources",{method:"GET",headers:{Authorization:`Bearer ${n.value}`},query:{character_id:i.currentCharacter.id}});if(e.success&&e.data){const s=e.data.find(w=>w.resource_type==="ouro");h.value=s?s.amount:0}}catch{}},E=n=>{c.value=n},S=async n=>{if(i.currentCharacter){try{const e=p("@mmo/ninja/token"),s=await $fetch("/api/story/start-battle",{method:"POST",headers:{Authorization:`Bearer ${e.value}`},body:{character_id:i.currentCharacter.id,chapter:n.chapter}});s.success&&s.data&&await F("/batalhas")}catch(e){alert(e.data?.message||"Erro ao iniciar batalha do capítulo")}c.value=null}};return G(async()=>{i.currentCharacter||(await i.loadCharacters(),i.characters.length>0&&i.selectCharacter(i.characters[0])),await z(),await V()}),(n,e)=>(d(),x("div",O,[e[18]||(e[18]=t("div",{class:"text-center"},[t("h1",{class:"text-2xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2"}," Modo História "),t("p",{class:"text-gray-600 dark:text-gray-400 text-sm md:text-base"}," Viva uma aventura épica através de capítulos desafiadores ")],-1)),a(i).currentCharacter?(d(),x("div",R,[t("div",H,[t("div",null,[t("h2",P,r(a(i).currentCharacter.name),1),t("p",J," Nível "+r(a(i).currentCharacter.level),1)]),t("div",L,[e[4]||(e[4]=t("span",{class:"text-yellow-500"},"💰",-1)),t("span",X,r(h.value),1)])])])):m("",!0),v.value?(d(),x("div",K,[...e[5]||(e[5]=[t("div",{class:"text-lg text-gray-600 dark:text-gray-400"}," Carregando capítulos... ",-1)])])):(d(),x("div",Q,[t("h2",U," Capítulos da História ("+r(y.value.length)+") ",1),t("div",W,[(d(!0),x(I,null,A(y.value,s=>(d(),f(a(B),{key:s.id,class:b(["transition-all duration-200",[s.can_play?"hover:shadow-lg cursor-pointer":"opacity-60",s.is_completed?"ring-2 ring-green-500 bg-green-50 dark:bg-green-900/20":"",s.is_locked?"ring-2 ring-red-500 bg-red-50 dark:bg-red-900/20":""]]),onClick:w=>s.can_play?E(s):null},{default:l(()=>[o(a(C),null,{default:l(()=>[t("div",Y,[o(a($),{class:"text-lg text-gray-900 dark:text-white"},{default:l(()=>[u(r(s.title),1)]),_:2},1024),t("div",Z,[o(a(g),{variant:q(s),class:"text-gray-900 dark:text-white"},{default:l(()=>[u(" Cap. "+r(s.chapter),1)]),_:2},1032,["variant"]),s.is_completed?(d(),f(a(g),{key:0,variant:"default",class:"bg-green-600 text-white"},{default:l(()=>[...e[6]||(e[6]=[u(" ✅ Completo ",-1)])]),_:1})):s.is_locked?(d(),f(a(g),{key:1,variant:"destructive"},{default:l(()=>[u(" 🔒 Nv. "+r(s.level_required),1)]),_:2},1024)):(d(),f(a(g),{key:2,variant:"secondary"},{default:l(()=>[...e[7]||(e[7]=[u(" ▶️ Disponível ",-1)])]),_:1}))])]),o(a(N),{class:"text-gray-700 dark:text-white"},{default:l(()=>[u(r(s.description),1)]),_:2},1024)]),_:2},1024),o(a(j),{class:"space-y-4"},{default:l(()=>[t("div",ee,[t("h4",te," Oponente: "+r(s.npc.name),1),t("div",se,[t("div",ae,[e[8]||(e[8]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Nível:",-1)),t("span",re,r(s.npc.level),1)]),t("div",le,[e[9]||(e[9]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Vida:",-1)),t("span",ie,r(s.npc.stats.health),1)]),t("div",ne,[e[10]||(e[10]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Força:",-1)),t("span",oe,r(s.npc.stats.strength),1)]),t("div",de,[e[11]||(e[11]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Defesa:",-1)),t("span",ce,r(s.npc.stats.defense),1)])])]),t("div",ue,[e[16]||(e[16]=t("h4",{class:"text-sm font-medium text-gray-900 dark:text-white"}," Recompensas: ",-1)),t("div",xe,[t("div",_e,[e[12]||(e[12]=t("span",{class:"text-blue-500"},"⭐",-1)),t("span",me,r(s.rewards.xp)+" XP",1)]),t("div",fe,[e[13]||(e[13]=t("span",{class:"text-yellow-500"},"💰",-1)),t("span",ge,r(s.rewards.gold)+" Ouro",1)]),s.rewards.items?.length?(d(),x("div",ye,[e[14]||(e[14]=t("span",{class:"text-green-500"},"🎁",-1)),t("span",ve,r(s.rewards.items.length)+" Itens",1)])):m("",!0),s.rewards.equipment?(d(),x("div",pe,[...e[15]||(e[15]=[t("span",{class:"text-purple-500"},"⚔️",-1),t("span",{class:"text-gray-900 dark:text-white"},"Equipamento",-1)])])):m("",!0)])]),t("div",ke,[t("div",he," Nível necessário: "+r(s.level_required),1),o(a(k),{disabled:!s.can_play,size:"sm",class:b(s.is_completed?"bg-green-600 text-white":s.is_locked?"bg-red-600 text-white":"bg-blue-600 text-white"),variant:s.is_completed?"secondary":s.is_locked?"destructive":"default"},{default:l(()=>[u(r(s.is_completed?"✅ Completo":s.is_locked?`🔒 Nv. ${s.level_required}`:"▶️ Iniciar Batalha"),1)]),_:2},1032,["disabled","class","variant"])])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])])),c.value?(d(),x("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:e[3]||(e[3]=s=>c.value=null)},[o(a(B),{class:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:e[2]||(e[2]=D(()=>{},["stop"]))},{default:l(()=>[o(a(C),null,{default:l(()=>[t("div",we,[o(a($),{class:"text-2xl text-gray-900 dark:text-white"},{default:l(()=>[u(r(c.value.title),1)]),_:1}),o(a(k),{onClick:e[0]||(e[0]=s=>c.value=null),variant:"ghost",size:"sm"},{default:l(()=>[...e[17]||(e[17]=[u(" ✕ ",-1)])]),_:1})]),o(a(N),{class:"text-gray-700 dark:text-white"},{default:l(()=>[u(r(c.value.description),1)]),_:1})]),_:1}),o(a(j),{class:"space-y-6"},{default:l(()=>[t("div",be,[t("p",Ce,r(c.value.story_text),1)]),t("div",$e,[o(a(k),{onClick:e[1]||(e[1]=s=>S(c.value)),disabled:c.value.level_required>(a(i).currentCharacter?.level||0),size:"lg",class:"w-full"},{default:l(()=>[u(r(c.value.level_required>(a(i).currentCharacter?.level||0)?"Nível Insuficiente":"Iniciar Batalha"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})])):m("",!0)]))}});export{Te as default};
