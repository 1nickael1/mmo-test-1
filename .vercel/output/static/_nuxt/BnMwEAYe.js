import{_ as z}from"./MSWrGCcy.js";import{c as A,b as D,_ as q,a as T}from"./gFKvgYVH.js";import{_ as X}from"./DPT98cEI.js";import{u as E}from"./BmWNdDnL.js";import{e as F,r as x,g as G,c as u,a,h as k,i as y,b as p,w as l,F as B,j as N,k as P,o,t as r,d as c,l as f,m as H}from"#entry";import"./BEHD0UYf.js";const I={class:"space-y-8"},L={key:0,class:"flex justify-center"},O={class:"text-center"},J={class:"text-lg md:text-xl font-bold text-gray-900 dark:text-white mb-2"},K={class:"flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-4 text-sm text-gray-600 dark:text-gray-400"},Q={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},U={class:"text-sm text-gray-600 dark:text-gray-400"},W={class:"flex justify-between text-sm"},Y={class:"font-medium"},Z={class:"flex justify-between text-sm"},ee={class:"font-medium"},te={key:0},ae={key:0,class:"text-center py-8"},se={key:1,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},re={class:"text-sm text-gray-600 dark:text-gray-400"},le={class:"flex justify-between text-sm"},oe={class:"font-medium"},de={class:"flex justify-between text-sm"},ne={class:"font-medium"},ce={key:0},ie={key:1},ye=F({__name:"missoes",setup(ue){const s=E(),v=x(!1),h=x(!1),w=x(!1),C=x([]),m=x([{id:"daily_battle_1",title:"Guerreiro Destemido",description:"Vença 3 batalhas contra oponentes",progress:0,target:3,completed:!1,rewards:{xp:200,gold:100,materials:5}},{id:"daily_skill_1",title:"Aprendiz Sábio",description:"Aprenda 1 nova habilidade",progress:0,target:1,completed:!1,rewards:{xp:150,gold:75,crystals:2}},{id:"daily_upgrade_1",title:"Construtor",description:"Complete 1 melhoria de base",progress:0,target:1,completed:!1,rewards:{xp:300,gold:200,materials:10}}]),R=async d=>{v.value=!0;try{const e=m.value.find(_=>_.id===d);e&&(e.completed=!0,s.currentCharacter&&await s.addXp(s.currentCharacter.id,e.rewards.xp))}catch{}finally{v.value=!1}},b=async d=>{if(s.currentCharacter){h.value=!0;try{const e=P("@mmo/ninja/token");if((await $fetch("/api/missions/complete",{method:"POST",headers:{Authorization:`Bearer ${e.value}`},body:{character_id:s.currentCharacter.id,mission_id:d}})).success){const i=C.value.find(n=>n.id===d);i&&(i.completed=!0),await s.loadCharacters()}}catch{}finally{h.value=!1}}},S=async()=>{if(s.currentCharacter){w.value=!0;try{const d=P("@mmo/ninja/token"),e=await $fetch(`/api/missions?level=${s.currentCharacter.level}&class=${s.currentCharacter.class}`,{headers:{Authorization:`Bearer ${d.value}`}});e.success&&(C.value=e.data||[])}catch{}finally{w.value=!1}}},V=()=>{if(!s.currentCharacter)return;const d=s.currentCharacter,e=m.value.find(n=>n.id==="daily_battle_1");e&&(e.progress=Math.min(3,Math.floor(d.level/2)));const _=m.value.find(n=>n.id==="daily_skill_1");_&&(_.progress=d.level>=3?1:0);const i=m.value.find(n=>n.id==="daily_upgrade_1");i&&(i.progress=d.level>=4?1:0)};return G(async()=>{s.currentCharacter||(await s.loadCharacters(),s.characters.length>0&&s.selectCharacter(s.characters[0])),await S(),V()}),(d,e)=>{const _=z,i=D,n=A,M=T,$=q,g=X;return o(),u("div",I,[e[11]||(e[11]=a("div",{class:"text-center"},[a("h1",{class:"text-2xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2"}," Missões "),a("p",{class:"text-gray-600 dark:text-gray-400 text-sm md:text-base"}," Complete missões para ganhar recompensas especiais ")],-1)),y(s).currentCharacter?(o(),u("div",L,[p(n,{class:"w-full max-w-md"},{default:l(()=>[p(i,{class:"p-4 md:p-6"},{default:l(()=>[a("div",O,[a("h2",J,r(y(s).currentCharacter.name),1),a("div",K,[p(_,{variant:y(s).currentCharacter.class==="ninja"?"default":"secondary"},{default:l(()=>[c(r(y(s).currentCharacter.class==="ninja"?"🥷 Ninja":"🚀 Guerreiro"),1)]),_:1},8,["variant"]),a("span",null,"Nível "+r(y(s).currentCharacter.level),1)])])]),_:1})]),_:1})])):k("",!0),a("div",null,[e[4]||(e[4]=a("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," Missões Diárias ",-1)),a("div",Q,[(o(!0),u(B,null,N(m.value,t=>(o(),f(n,{key:t.id,class:"hover:shadow-lg transition-shadow"},{default:l(()=>[p($,{class:"pb-2"},{default:l(()=>[p(M,{class:"text-lg flex items-center gap-2"},{default:l(()=>[c(r(t.title),1)]),_:2},1024)]),_:2},1024),p(i,{class:"space-y-3"},{default:l(()=>[a("p",U,r(t.description),1),a("div",W,[e[0]||(e[0]=a("span",{class:"text-gray-600 dark:text-gray-400"},"Progresso:",-1)),a("span",Y,r(t.progress)+"/"+r(t.target),1)]),a("div",Z,[e[1]||(e[1]=a("span",{class:"text-gray-600 dark:text-gray-400"},"Recompensas:",-1)),a("span",ee,[c(r(t.rewards.xp)+" XP, "+r(t.rewards.gold)+" 🪙 ",1),t.rewards.materials?(o(),u("span",te,", "+r(t.rewards.materials)+" ⚙️",1)):k("",!0)])]),t.completed?(o(),f(g,{key:0,disabled:"",variant:"success",class:"w-full"},{default:l(()=>[...e[2]||(e[2]=[c(" ✅ Concluída ",-1)])]),_:1})):t.progress>=t.target?(o(),f(g,{key:1,onClick:j=>R(t.id),disabled:v.value,class:"w-full"},{default:l(()=>[c(r(v.value?"Resgatando...":"Resgatar Recompensa"),1)]),_:1},8,["onClick","disabled"])):(o(),f(g,{key:2,disabled:"",variant:"outline",class:"w-full"},{default:l(()=>[...e[3]||(e[3]=[c(" Em Progresso ",-1)])]),_:1}))]),_:2},1024)]),_:2},1024))),128))])]),a("div",null,[e[10]||(e[10]=a("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," Missões da História ",-1)),w.value?(o(),u("div",ae,[...e[5]||(e[5]=[a("p",{class:"text-gray-500 dark:text-gray-400"},"Carregando missões...",-1)])])):(o(),u("div",se,[(o(!0),u(B,null,N(C.value,t=>(o(),f(n,{key:t.id,class:H({"hover:shadow-lg transition-shadow cursor-pointer":t.available&&!t.completed,"opacity-60 cursor-not-allowed":!t.available||t.completed}),onClick:j=>t.available&&!t.completed?b(t.id):null},{default:l(()=>[p($,{class:"pb-2"},{default:l(()=>[p(M,{class:"text-lg flex items-center gap-2"},{default:l(()=>[c(" 📖 "+r(t.title),1)]),_:2},1024)]),_:2},1024),p(i,{class:"space-y-3"},{default:l(()=>[a("p",re,r(t.description),1),a("div",le,[e[6]||(e[6]=a("span",{class:"text-gray-600 dark:text-gray-400"},"Requisitos:",-1)),a("span",oe,"Nível "+r(t.required_level),1)]),a("div",de,[e[7]||(e[7]=a("span",{class:"text-gray-600 dark:text-gray-400"},"Recompensas:",-1)),a("span",ne,[c(r(t.rewards.xp)+" XP, "+r(t.rewards.gold)+" 🪙 ",1),t.rewards.materials?(o(),u("span",ce,", "+r(t.rewards.materials)+" ⚙️",1)):k("",!0),t.rewards.crystals?(o(),u("span",ie,", "+r(t.rewards.crystals)+" 💎",1)):k("",!0)])]),t.completed?(o(),f(g,{key:0,disabled:"",variant:"success",class:"w-full"},{default:l(()=>[...e[8]||(e[8]=[c(" ✅ Concluída ",-1)])]),_:1})):t.available?(o(),f(g,{key:1,onClick:j=>b(t.id),disabled:h.value,class:"w-full"},{default:l(()=>[c(r(h.value?"Iniciando...":"Iniciar Missão"),1)]),_:1},8,["onClick","disabled"])):(o(),f(g,{key:2,disabled:"",variant:"outline",class:"w-full"},{default:l(()=>[...e[9]||(e[9]=[c(" Bloqueada ",-1)])]),_:1}))]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]))])])}}});export{ye as default};
