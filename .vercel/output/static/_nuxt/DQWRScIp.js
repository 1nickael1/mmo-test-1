import{_ as G}from"./CIl2gqAq.js";import{c as J,b as A,_ as K,a as Q}from"./gFKvgYVH.js";import{_ as W}from"./DPT98cEI.js";import{_ as X}from"./DWXLwVMu.js";import{e as Y,r as p,f as L,g as Z,L as tt,v as st,c as i,a as s,h as k,b as c,w as n,F as N,j,o as l,t as r,m as T,d as o,l as u,J as U}from"#entry";import{u as et}from"./BmWNdDnL.js";import{u as at}from"./DHKOOHM0.js";import"./BEHD0UYf.js";import"./D3nKW_CT.js";const rt={class:"space-y-8"},lt={key:0,class:"flex justify-center"},nt={class:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center"},ot={class:"text-2xl"},it={class:"text-sm text-gray-600 dark:text-gray-400 capitalize"},ct={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},dt={class:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm"},ut={class:"text-center"},mt={class:"space-y-1 text-gray-600 dark:text-gray-400"},ft={class:"text-center"},_t={class:"space-y-1 text-gray-600 dark:text-gray-400"},xt={key:1,class:"text-center py-8"},yt={key:2,class:"space-y-8"},vt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},gt={class:"text-sm text-gray-600 dark:text-gray-400"},pt={class:"space-y-2 text-sm"},kt={class:"flex justify-between"},bt={class:"font-medium"},ht={class:"flex justify-between"},Ct={class:"font-medium"},wt={key:0,class:"flex justify-between"},Mt={class:"font-medium"},$t={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Rt={class:"text-sm text-gray-600 dark:text-gray-400"},It={class:"space-y-2 text-sm"},Nt={class:"flex justify-between"},jt={class:"font-medium"},Tt={class:"flex justify-between"},Bt={class:"font-medium"},St={key:0,class:"flex justify-between"},Lt={class:"font-medium"},Ut={key:1,class:"flex justify-between"},Vt={class:"font-medium"},Ot={class:"flex justify-between"},Pt={class:"font-medium"},zt={key:0,class:"space-y-2"},Dt={class:"text-xs text-gray-600 dark:text-gray-400"},Xt=Y({__name:"melhorias",setup(Et){const m=et(),w=p(!1),_=p(!1),x=p([]),y=p([]),M=p(null),V=L(()=>y.value.filter(a=>a.type==="stat")),O=L(()=>y.value.filter(a=>a.type==="building")),P=a=>{switch(a){case"ouro":return"ü™ô";case"cristais":return"üíé";case"materiais":return"‚öôÔ∏è";default:return"üì¶"}},z=a=>{switch(a){case"ouro":return"text-yellow-600 dark:text-yellow-400";case"cristais":return"text-blue-600 dark:text-blue-400";case"materiais":return"text-gray-600 dark:text-gray-400";default:return"text-gray-600 dark:text-gray-400"}},B=a=>a<60?`${a}s`:a<3600?`${Math.floor(a/60)}m`:`${Math.floor(a/3600)}h ${Math.floor(a%3600/60)}m`,D=a=>{const t=Math.floor(a/1e3);return B(t)},E=a=>{if(!a.time_remaining||!a.time_seconds)return 0;const t=a.time_seconds*1e3;return(t-a.time_remaining)/t*100},S=a=>{const t=parseInt(a);return y.value.find(f=>parseInt(f.id)===t)?.level||1},F=()=>{y.value=y.value.map(a=>{if(a.time_remaining>0){const t=Math.max(0,a.time_remaining-1e3);return t===0?{...a,time_remaining:0,can_upgrade:!0,current_level:a.current_level+1}:{...a,time_remaining:t}}return a})},$=async()=>{if(m.currentCharacter){w.value=!0;try{const a=await $fetch(`/api/resources/${m.currentCharacter.id}`);x.value=a.data||[];const v=(await $fetch(`/api/upgrades/available?level=${m.currentCharacter.level}&characterId=${m.currentCharacter.id}`)).data||[],f=x.value.find(e=>e.resource_type==="ouro"),g=x.value.find(e=>e.resource_type==="materiais"),h=x.value.find(e=>e.resource_type==="cristais"),C=f?.amount||0,d=g?.amount||0,R=h?.amount||0;y.value=v.map(e=>({...e,can_afford:C>=(e.current_cost?.gold||0)&&d>=(e.current_cost?.materials||0)&&R>=(e.current_cost?.crystals||0)}))}catch{}finally{w.value=!1}}},b=async a=>{if(m.currentCharacter){_.value=!0;try{(await $fetch("/api/upgrades/start",{method:"POST",body:{character_id:m.currentCharacter.id,upgrade_id:a}})).success&&(await $(),await m.loadCharacters())}catch{}finally{_.value=!1}}},{ensureCharacterSelected:H,onCharacterChange:q}=at();return Z(async()=>{await H(),await $(),M.value=tt(F,1e3),q(async a=>{await $()})}),st(()=>{M.value&&clearInterval(M.value)}),(a,t)=>{const v=G,f=A,g=J,h=Q,C=K,d=W,R=X;return l(),i("div",rt,[t[31]||(t[31]=s("div",{class:"text-center"},[s("h1",{class:"text-2xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2"}," Melhorias "),s("p",{class:"text-gray-600 dark:text-gray-400 text-sm md:text-base"}," Construa e melhore sua base espacial ")],-1)),x.value.length>0?(l(),i("div",lt,[c(g,{class:"w-full max-w-4xl"},{default:n(()=>[c(f,{class:"p-4 md:p-6"},{default:n(()=>[s("div",nt,[(l(!0),i(N,null,j(x.value,e=>(l(),i("div",{key:e.resource_type,class:"space-y-2"},[s("div",ot,r(P(e.resource_type)),1),s("div",{class:T(["text-lg font-bold",z(e.resource_type)])},r(e.amount.toLocaleString()),3),s("div",it,r(e.resource_type),1)]))),128))]),s("div",ct,[t[14]||(t[14]=s("h3",{class:"text-lg font-semibold mb-4 text-center"}," Como Obter Recursos ",-1)),s("div",dt,[t[13]||(t[13]=s("div",{class:"text-center"},[s("div",{class:"text-2xl mb-2"},"ü™ô"),s("h4",{class:"font-semibold mb-2"},"Ouro"),s("ul",{class:"space-y-1 text-gray-600 dark:text-gray-400"},[s("li",null,"‚Ä¢ Batalhas (sempre)"),s("li",null,"‚Ä¢ Miss√µes"),s("li",null,"‚Ä¢ Modo hist√≥ria")])],-1)),s("div",ut,[t[4]||(t[4]=s("div",{class:"text-2xl mb-2"},"‚öôÔ∏è",-1)),t[5]||(t[5]=s("h4",{class:"font-semibold mb-2"},"Materiais",-1)),s("ul",mt,[s("li",null,[t[1]||(t[1]=o(" ‚Ä¢ ",-1)),c(v,{to:"/mineracao",class:"text-blue-600 hover:underline"},{default:n(()=>[...t[0]||(t[0]=[o("Minera√ß√£o",-1)])]),_:1})]),t[2]||(t[2]=s("li",null,"‚Ä¢ Batalhas (40% chance)",-1)),t[3]||(t[3]=s("li",null,"‚Ä¢ Miss√µes especiais",-1))])]),s("div",ft,[t[11]||(t[11]=s("div",{class:"text-2xl mb-2"},"üíé",-1)),t[12]||(t[12]=s("h4",{class:"font-semibold mb-2"},"Cristais",-1)),s("ul",_t,[s("li",null,[t[7]||(t[7]=o(" ‚Ä¢ ",-1)),c(v,{to:"/mineracao",class:"text-blue-600 hover:underline"},{default:n(()=>[...t[6]||(t[6]=[o("Minera√ß√£o",-1)])]),_:1})]),t[8]||(t[8]=s("li",null,"‚Ä¢ Batalhas (10% chance)",-1)),t[9]||(t[9]=s("li",null,"‚Ä¢ Miss√µes de elite",-1)),t[10]||(t[10]=s("li",null,"‚Ä¢ Hist√≥ria avan√ßada",-1))])])])])]),_:1})]),_:1})])):k("",!0),w.value?(l(),i("div",xt,[...t[15]||(t[15]=[s("div",{class:"text-lg text-gray-600 dark:text-gray-400"}," Carregando melhorias... ",-1)])])):(l(),i("div",yt,[s("div",null,[t[21]||(t[21]=s("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," Melhorias de Stats ",-1)),s("div",vt,[(l(!0),i(N,null,j(V.value,e=>(l(),u(g,{key:e.id,class:T(["hover:shadow-lg transition-all duration-200",e.can_afford&&e.can_upgrade?"cursor-pointer hover:scale-105":"opacity-60"]),onClick:I=>e.can_afford&&e.can_upgrade?b(e.id):null},{default:n(()=>[c(C,{class:"pb-2"},{default:n(()=>[c(h,{class:"text-lg flex items-center gap-2"},{default:n(()=>[t[16]||(t[16]=s("span",{class:"text-blue-600 dark:text-blue-400"},"üìà",-1)),o(" "+r(e.name),1)]),_:2},1024)]),_:2},1024),c(f,{class:"space-y-3"},{default:n(()=>[s("p",gt,r(e.description),1),s("div",pt,[s("div",kt,[t[17]||(t[17]=s("span",{class:"text-gray-600 dark:text-gray-400"},"N√≠vel:",-1)),s("span",bt,r(e.current_level)+"/"+r(e.max_level),1)]),s("div",ht,[t[18]||(t[18]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Custo:",-1)),s("span",Ct,r(e.current_cost.gold)+" ü™ô",1)]),e.current_cost.materials>0?(l(),i("div",wt,[t[19]||(t[19]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Materiais:",-1)),s("span",Mt,r(e.current_cost.materials)+" ‚öôÔ∏è",1)])):k("",!0)]),e.can_afford&&e.can_upgrade?(l(),u(d,{key:0,onClick:U(I=>b(e.id),["stop"]),disabled:_.value,class:"w-full"},{default:n(()=>[o(r(_.value?"Melhorando...":"Melhorar"),1)]),_:1},8,["onClick","disabled"])):e.can_upgrade?(l(),u(d,{key:2,disabled:"",variant:"outline",class:"w-full"},{default:n(()=>[...t[20]||(t[20]=[o(" Recursos Insuficientes ",-1)])]),_:1})):(l(),u(d,{key:1,disabled:"",variant:"outline",class:"w-full"},{default:n(()=>[o(" N√≠vel "+r(S(e.id))+" Necess√°rio ",1)]),_:2},1024))]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])]),s("div",null,[t[30]||(t[30]=s("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," Melhorias de Base ",-1)),s("div",$t,[(l(!0),i(N,null,j(O.value,e=>(l(),u(g,{key:e.id,class:T(["hover:shadow-lg transition-all duration-200",e.can_afford&&e.can_upgrade?"cursor-pointer hover:scale-105":"opacity-60"]),onClick:I=>e.can_afford&&e.can_upgrade?b(e.id):null},{default:n(()=>[c(C,{class:"pb-2"},{default:n(()=>[c(h,{class:"text-lg flex items-center gap-2"},{default:n(()=>[t[22]||(t[22]=s("span",{class:"text-green-600 dark:text-green-400"},"üèóÔ∏è",-1)),o(" "+r(e.name),1)]),_:2},1024)]),_:2},1024),c(f,{class:"space-y-3"},{default:n(()=>[s("p",Rt,r(e.description),1),s("div",It,[s("div",Nt,[t[23]||(t[23]=s("span",{class:"text-gray-600 dark:text-gray-400"},"N√≠vel:",-1)),s("span",jt,r(e.current_level)+"/"+r(e.max_level),1)]),s("div",Tt,[t[24]||(t[24]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Custo:",-1)),s("span",Bt,r(e.current_cost.gold)+" ü™ô",1)]),e.current_cost.materials>0?(l(),i("div",St,[t[25]||(t[25]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Materiais:",-1)),s("span",Lt,r(e.current_cost.materials)+" ‚öôÔ∏è",1)])):k("",!0),e.current_cost.crystals>0?(l(),i("div",Ut,[t[26]||(t[26]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Cristais:",-1)),s("span",Vt,r(e.current_cost.crystals)+" üíé",1)])):k("",!0),s("div",Ot,[t[27]||(t[27]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Tempo:",-1)),s("span",Pt,r(B(e.time_seconds||0)),1)])]),e.time_remaining>0?(l(),i("div",zt,[s("div",Dt," Tempo restante: "+r(D(e.time_remaining)),1),c(R,{value:E(e),class:"h-2"},null,8,["value"])])):k("",!0),e.can_afford&&e.can_upgrade&&e.time_remaining<=0?(l(),u(d,{key:1,onClick:U(I=>b(e.id),["stop"]),disabled:_.value,class:"w-full"},{default:n(()=>[o(r(_.value?"Iniciando...":"Iniciar Constru√ß√£o"),1)]),_:1},8,["onClick","disabled"])):e.time_remaining>0?(l(),u(d,{key:2,disabled:"",variant:"outline",class:"w-full"},{default:n(()=>[...t[28]||(t[28]=[o(" Em Constru√ß√£o ",-1)])]),_:1})):e.can_upgrade?(l(),u(d,{key:4,disabled:"",variant:"outline",class:"w-full"},{default:n(()=>[...t[29]||(t[29]=[o(" Recursos Insuficientes ",-1)])]),_:1})):(l(),u(d,{key:3,disabled:"",variant:"outline",class:"w-full"},{default:n(()=>[o(" N√≠vel "+r(S(e.id))+" Necess√°rio ",1)]),_:2},1024))]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])])]))])}}});export{Xt as default};
